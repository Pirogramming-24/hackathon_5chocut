

{% extends 'piro_index/base.html' %}
{% load static %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'video_detail.css' %}">
    <script src="{% static 'js/video_detail.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<div class="video_play">
    <video id="lecture" controls poster="{% static 'images/video_error.png' %}">
        <source src="{{ video.video_path.url }}" type="video/mp4">
    </video>
    <h3>{{ video.title }}</h3>
</div>

<div class="timeline_table">
    <h6>ğŸ“Œ ì£¼ìš” ê°œë… ë‹¤ì‹œë³´ê¸° ğŸ“Œ</h6>
    {% for timeline in timelines %}
        <div class="index_content" onclick="seekTo({{ timeline.timetag }})">
            <p class="main_concept">{{ timeline.content }}</p>
            <p class="time">{{ timeline.timetag }}</p>
        </div>
    {% endfor %}
</div>

<div class="sw-container">
    <div class="user-profile">
        <span>{{ user.name|slice:":1" }}</span>
    </div>
    <div class="input-area">
        <textarea id="comment-content" placeholder="ì´í•´ê°€ ê°€ì§€ ì•ŠëŠ” ì§ˆë¬¸ì„ ë“±ë¡í•´ì£¼ì„¸ìš”! ìš´ì˜ì§„ì´ ì¹œì ˆí•˜ê²Œ ë‹µë³€í•´ë“œë¦½ë‹ˆë‹¤"></textarea>
        <button type="button" id="comment-submit-btn" onclick="submitComment({{ video.pk }})">ë“±ë¡</button>

    </div>
</div>

<div class="graph_section">
    <canvas id="questionChart"></canvas> 

    <script>
        // ëŒ“ê¸€ë§ˆë‹¤ [ì‹œê°„, ê³µê°ìˆ˜] ìŒìœ¼ë¡œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“­ë‹ˆë‹¤.
        const empathyData = [
            {% for c in comments %}
                { time: {{ c.timetag }}, likes: {{ c.like_count }} }, // like_countëŠ” ëª¨ë¸ì˜ ê³µê°ìˆ˜ í•„ë“œëª…
            {% endfor %}
        ];
        
        // ì´ì œ ì´ ë°ì´í„°ë¥¼ í•¨ìˆ˜ì— ë˜ì§‘ë‹ˆë‹¤.
        drawEmpathyGraph(empathyData);
    </script>
</div>


{% endblock %}

